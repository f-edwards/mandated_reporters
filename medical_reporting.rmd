---
title: "Medical reporting of infants for child abuse and neglect, national"
author: "Frank Edwards"
output: bookdown::pdf_document2
---

```{r include=FALSE}
library(tidyverse)
library(knitr)
library(gridExtra)
library(scales)

knitr::opts_chunk$set(echo = F, warning = F, message = F)
theme_set(theme_bw())
```

```{r include=FALSE, cache = T}
source("report_setup.r")
```

## Intro

In 1990, Chasnoff and colleagues published a study based on data they collected in Pinellas County, Florida. In this paper, the authors documented no statistically significant differences by race/ethnicity in the proportion of pregnant women using alcohol and drugs at their first prenatal visit, but found that Black women were 10 times more likely than white women to be reported togovernment health authorities after delivery for “maternal substance abuse during pregnancy.” [CITATION]. In the three decades since it was published, this paper has been cited over 900 times in the scholarly literature, and continues to be used by scholars, clinicians, and activists as a justification for their efforts to reduce racial inequities in reporting to government authorities ingeneral and Child Protective Services (CPS) in particular related to maternal substance use during pregnancy. A recent ACOG [SPELL OUT] statement named the importance of reducing these inequities [SAY MORE – MISHKA?]. 

Between 1990 and 2021, the number of states with laws mandating reporting of alcohol and/or drug use during pregnancy to health authorities and/or CPS increased from X to X. Over this same time period, hospitals have developed and revised policies and protocols to guide what some [CLINICICIANS, ACTIVISTS?] have started to refer to as “test and report” policies. Suchprotocols/policies are designed both to ensure legally mandated reporting occurs [NOT SURE WE WANT TO SAY THIS] and also with a stated goal of reducing racial inequities in reporting to CPS [CITATIONS]. 

Despite all of this state and hospital-policy activity over this time period, we have very little information about reporting to CPS related to pregnant people’s use of alcohol and drugs [I’M USING DIFFERENT LANGUAGE IN DIFFERENT PLACES SO WE CAN HAVE AN INTENTIONAL CONVERSAITON ABOUT THE LANGUAGE TO USE] in general or in the extent to which such reporting inequities persist. Studying current reporting rates and current inequities in reporting is important, as these state and hospital policies could plausibly influence both of them. Specifically, such policies could reduce racial inequities in reporting by eliminating bias in individual practices; yet, the one study that evaluated such a hospital policy found that standardizing practices may just institutionalize the racism that existed in previous provider practices [CITATION]. To the extent such policy changes contribute to reduced racial inequities in reporting, it could be either through increasing the numbers of white newborns reported or in decreasing the number of Black newborns reported [CITATION]. The ways that reduced inequities come to be matter [SAY SOMETHING MORE AND MORE CRITICAL OF CHILD WELFARE SYSTEM].  

Yet, since 1990, only a few studies have looked at reporting of newborns related to maternal substance use during pregnancy. The few studies that have been published find that rates of CPS reporting related to maternal alcohol and/or drug use during pregnancy range from 0.3% of live births to 0.8% of live births.{Hoerr, 2018 #7245;Rebbe, 2019 #7261;Prindle, 2018 #7260;Putnam-Hornstein, 2016 #6591;Roberts, 2012 #4240}  Reports to health authorities (such as the health department), often for data and treatment purposes, may be slightly higher, i.e. around 1.2% in one study.{Hoerr, 2018 #7245}  The two studies that have looked at racial inequities in reporting find that health care providers report Black newborns to CPS or health authorities up to four to five times more often than they report White newborns,{Roberts, 2015 #5877;Roberts, 2012 #4240} with about 2.5% of Black newborns reported in another.{Roberts, 2015 #5877;Roberts, 2012 #4240} Most of these data, though, come from single states or single 
counties and are more than a decade old.  The two studies that examine racial inequities in reporting come from Northern California counties in the mid-2000s and thus may not be generalizable to other areas of the country or other time periods.

National data exist about racial differences [NEED TO AGREE UPON CONSISTENT LANGUAGE] in child welfare involvement in general [FRANK, I THINK YOU WROTE THE RECENT PAPER ON ESTIMATING RACIAL DIFFERENCES IN RATES OF INVOLVEMENT IN GENERAL AND IT WOULD BE GREAT IF YOU COULD FILL IT IN].This data source also includes a variable for report source and age of child at the report, which could be used to estimate reporting rates overall and racial differences in reporting rates. Yet the data collection system on which these estimates are based has, historically, not included codes for whether the report was related to substance use [CONFIRM] in general or maternal substanceuse during pregnancy [LANGUAGE] in particular. As of X date, though [DUE TO A NEW POLICY REQUIREMENT?], multiple states have started to include a variable for these types of reports. Thus, in this paper, we examine [DATA SOURCE DATA] to estimate the extent to which health care providers report infants to CPS related to maternal substance use during pregnancy and to describe the racial inequities in such reporting. This analysis is important as it contributes to our growing understanding of the ways that health providers uphold [WORD CHOICE] structural racism and can serve as a baseline to evaluate future efforts to reduce racial inequities in reporting and [SOMETHING ELSE]. 

## Methods

### data sources

NCANDS, AFCARS, SEER pop

### data quality and missing data imputation

talk about inclusion criteria for NCANDS drugs. NAME STATES WITH POOR DATA

we don't impute rptsrc. assumption is rptsrc == medical is much less likely to be missing than other categories, so pr(missing) ~ pr(medical) and we don't meet MAR assumptions. impute chage and race_ethn

there are a small N of prenatal investigations reported (0.1% of all compared to 8% for infants) - we lump them with infants for convenience. 

alternative with births data might be better, but the race data isn't a great match because of mom/dad race variables. requires assumptions about race id - using CDC seer data for simplicity on match

### data matching / other methods? no models here

## Results

### Report source

Medical professionals are a major source of reports to child protection agencies, and consitute a key component of systems of family surveillance organized under the umbrella of mandated reporting. Medical professionals were the origin of `r nat_ncands %>% filter(.imp==1, rptsrc=="medical") %>% summarise(n_total = sum(n_total))` investigated maltreatment reports in 2018, about 9 percent of all reports nationally. Medical professionals were responsible for about 14 percent of all investigations originating from a professional mandated reporter. We show the distribution of reports by source and child age for 2018 in Figure \@ref(fig:all).

Figure \@ref(fig:allRace) shows rates of reporting by type of reporter by child race/ethnicity and age. For the most active types of mandated reporters -- education personnel, medical personnel, police, and social service personnel -- Black and Native children are reported more often than their white peers. Note that medical professionals report Black and Native infants at exceptionally high rates. 

```{r all, fig.cap = "Children subject to CPS investigations in 2018"}
#### FIG 1 reporting rates for all professional mandated reporters, 2010 - 2019 average rates
### DO THIS AS A TS

plot_dat<-nat_ncands %>% 
  ungroup() %>% 
  filter(rptsrc != "Non - Mandated" & 
           rptsrc != "Unknown") %>% 
  group_by(.imp, rptsrc, year) %>% 
  summarise(n = sum(n_total)) %>%
  ungroup() %>% 
  group_by(rptsrc, year) %>% 
  summarise(n_mn = mean(n),
            n_upr = max(n),
            n_lwr = min(n)) 

ggplot(plot_dat,
       aes(x = year, y = n_mn, 
           color = rptsrc)) + 
  geom_line()+
  scale_x_continuous(breaks = c(2010, 2012, 2014, 2016, 2018))  +
  labs(y = "Infants investigated",
       x = "Year",
       color = "Report Source") 

```


FIG 1 TS of counts relative to other reporters
FIG 2 is MED PER CAPITA BY RACE AND RATE RATIO


ESTABLISHED THAT MEDICAL REPORTS INFANTS AT HIGHER RATES THAN OTHER MANDATED RPTRS

NEXT LOOK AT MEDICAL TIME SERIES

REDO THIS AS RATE RATIOS


```{r}
#### FIG 2 MEDICAL TIME SERIES RPT RATE AND RATE RATIO

plot_dat<-nat_ncands %>% 
  filter(rptsrc=="Medical",
         age == 0) %>% 
  group_by(.imp, year, race_ethn) %>% 
  summarise(n = sum(n_total)) %>%
  ungroup() %>% 
  group_by(year, race_ethn) %>% 
  summarise(n_mn = mean(n),
            n_upr = max(n),
            n_lwr = min(n)) %>% 
  left_join(pop %>% 
              group_by(year, age, race_ethn) %>% 
              summarise(pop = sum(pop))) %>% 
  ungroup() %>% 
  mutate(rpts_mn = n_mn/pop * 1000,
         rpts_upr = n_upr / pop * 1000,
         rpts_lwr = n_lwr / pop * 1000) %>% 
  filter(!(is.na(pop)))

plot_dat<-plot_dat %>% 
  left_join(
    plot_dat %>% 
      filter(race_ethn == "White") %>% 
      rename(white_mn = rpts_mn,
             white_lwr = rpts_lwr,
             white_upr = rpts_upr) %>% 
      select(-race_ethn, -n_mn, -n_upr, -n_lwr, -pop)) %>% 
  mutate(d_mn = rpts_mn/white_mn,
         d_lwr = rpts_upr/white_lwr,
         d_upr = rpts_lwr/white_upr) 

p1<-ggplot(plot_dat,
       aes(x = year,
           y = d_mn,
           ymin = d_lwr,
           ymax = d_upr,
           color = race_ethn,
           fill = race_ethn)) + 
  geom_line() + 
  geom_ribbon(alpha = 0.5, color = NA) + 
  labs(x = "Year",
       y = "Investigation rate ratio (relative to white)",
       color = "",
       fill = "") + 
  theme(legend.position = "none") + 
  scale_x_continuous(breaks = c(2010, 2012, 2014, 2016, 2018))

p2<-ggplot(plot_dat,
       aes(x = year,
           y = rpts_mn,
           ymin = rpts_lwr,
           ymax = rpts_upr,
           color = race_ethn,
           fill = race_ethn)) + 
  geom_line() + 
  geom_ribbon(alpha = 0.5, color = NA) + 
  labs(x = "Year",
       y = "Investigations per 1,000 infants",
       color = "",
       fill = "") + 
  scale_x_continuous(breaks = c(2010, 2012, 2014, 2016, 2018))

grid.arrange(p1, p2, nrow = 1)
```

Describe panel 1 and panel 2

```{r}
library(geofacet)
### appx fig map of med rpt rate by state
plot_dat<-state_ncands %>% 
  filter(rptsrc=="Medical",
         age == 0) %>% 
  group_by(.imp, staterr, year, race_ethn) %>% 
  summarise(n = sum(n_total)) %>%
  ungroup() %>% 
  group_by(year, staterr, race_ethn) %>% 
  summarise(n_mn = mean(n),
            n_upr = max(n),
            n_lwr = min(n)) %>% 
  ungroup() %>% 
  rename(state = staterr) %>% 
  left_join(pop %>% 
              group_by(year, state, age, race_ethn) %>% 
              summarise(pop = sum(pop))) %>% 
  ungroup() %>% 
  mutate(rpts_mn = n_mn/pop * 1000,
         rpts_upr = n_upr / pop * 1000,
         rpts_lwr = n_lwr / pop * 1000) %>% 
  filter(!(is.na(pop)))

ggplot(plot_dat,
       aes(x = year, y = rpts_mn,
           ymin = rpts_lwr, ymax = rpts_upr,
           color = race_ethn, fill = race_ethn))+
  geom_ribbon(alpha = 0.3, color = NA) +
  geom_line() +
  facet_geo(~state) + 
  coord_cartesian(ylim = c(0, 200)) + 
  scale_x_discrete(labels = rep("", 10), breaks = 2010:2019) + 
  labs(x = "Year (2010 - 2019)", y = "Reports per 1,000 infants", fill = "Race / Ethnicity",
       color = "Race / Ethnicity")
```


## STATES WITH VALID DRUG REPORTING NCANDS DATA

REPLICATE FIG1, 2, 3 for SUBSET in SINGLE GRID PLOT

```{r}
### fig 3 rates for states with valid drug report data
### check on substantiation for data quality

### compute per capita rpt rates for w/subst_ab
ggplot(state_dat_subst,
       aes(x = year, 
           y = pct_subst_mn,
           color = race_ethn)) + 
  geom_line() + 
  facet_wrap(~state)
### I don't think this is useable...
### going to need to do the AFCARS backtrace  
```


